{"version":3,"file":null,"sources":["../src/lib/set_events.js","../src/lib/set_elements.js","../src/lib/operations.js","../src/lib/global_dom_exists.js","../src/lib/is_element.js","../src/index.js"],"sourcesContent":["\nexport default function setEvents(root, events){\n\n    while(events.length){\n        let event = events.shift();\n        let element = root.querySelector(`[${event.attribute}=\"${event.id}\"]`);\n        if(element && event.event in element){\n            element.addEventListener(event.event, event.listener, false);\n            element.removeAttribute(event.attribute);\n        }\n\n    }\n};\n","import domSearchReplace from 'dom-search-replace';\n\nexport default function setElements(root, elements){\n    for(let element of elements){\n        domSearchReplace(root, element.id, element.element);\n    }\n    return root;\n};\n","import isElement from 'is-element';\nimport nodeToString from 'dom-node-tostring';\nlet operations = [];\n\nObject.defineProperties(operations, {\n    appendTo: {\n        value: function(element){\n            if(typeof element === 'string'){\n                try{\n                    element = document.querySelector(element);\n                }catch(e){ throw new TypeError(element + ' is not a valid selector.') }\n            }\n\n            if(!isElement(element)){\n                throw new TypeError(element + ' is not a DOM element.')\n            }\n\n            element.appendChild(this[0]);\n        }\n    },\n    html: {\n        value: function(){\n            return nodeToString(this[0]);\n        }\n    }\n});\n\nexport default function createDOMOperations(dom){\n    let ops = Object.create(operations);\n\n    Object.defineProperties(ops, {\n        0: {\n            get: function(){\n                return dom;\n            }\n        }\n    });\n\n    return ops;\n};\n","export default\n    typeof document !== 'undefined' &&\n    typeof document.getElementById === 'function' &&\n    typeof document.createDocumentFragment === 'function';\n","export default function isElement(value) {\n    return (value && value.nodeType === 1) &&\n           (value && typeof value == 'object') &&\n           (Object.prototype.toString.call(value).indexOf('Element') > -1);\n}\n","import setEvents from './lib/set_events';\nimport setElements from './lib/set_elements';\nimport createDOMOperations from './lib/operations';\nimport domExists from './lib/global_dom_exists';\nimport isElement from './lib/is_element.js';\nimport domFrom from 'dom-from';\nimport escapeHTML from 'escape-html';\nimport createID from 'really-unique-id';\n\nconst defaultOptions = {\n    domlib: createDOMOperations,\n    escape: escapeHTML\n};\n\nfunction createDOMTemplate({\n    domlib: domlib = createDOMOperations,\n    escape: escape = escapeHTML\n} = {}){\n\n    return function html(strings){\n\n        const values = [].slice.call(arguments, 1);\n\n        let result = '',\n            string = strings[0],\n            elements = [],\n            events = [],\n            dom = null;\n\n        for(let i=0; i<values.length; i++){\n\n            let value = values[i];\n            let type = typeof value;\n\n            if(type === 'string'){\n                result += string + escape(value);\n            }else if(domExists){\n                if(type === 'object'){\n                    if(isElement(value) || typeof value.appendTo === 'function'){\n                        let id = createID();\n\n                        elements.push({\n                            id: id,\n                            element: value\n                        });\n\n                        result += string + id;\n                    }else{\n                        throw new TypeError(`${value} is not a valid element, or does not have\n                            an appendTo method.`);\n                    }\n                }else if(type === 'function'){\n                    let m;\n                    if(m = string.match(/[\\s](on[\\S]+)=$/)){\n\n                        let id = createID();\n                        events.push({\n                            id: id,\n                            attribute: m[1],\n                            event: m[1].replace('on', ''),\n                            listener: value\n                        });\n                        result += string + '\"' + id + '\"';\n                    }else{\n                        throw new TypeError(m[1]+' is not an event attribute.');\n                    }\n                }\n            }else{\n                result += string + escape(value);\n            }\n\n            string = strings[i + 1];\n        }\n\n        result = (result += string).trim();\n\n        if(domExists){\n            dom = domFrom(result);\n\n            dom = setElements(dom, elements);\n            setEvents(dom, events);\n        }\n\n        return domlib(dom || result);\n    };\n}\n\n\nexport default createDOMTemplate;\n\n/*\ngit remote add origin https://github.com/hollowdoor/dom_compose.git\ngit push -u origin master\n*/\n"],"names":["setEvents","root","events","length","event","shift","element","querySelector","attribute","id","addEventListener","listener","removeAttribute","setElements","elements","operations","Object","defineProperties","document","e","TypeError","isElement","appendChild","nodeToString","createDOMOperations","dom","ops","create","getElementById","createDocumentFragment","value","nodeType","prototype","toString","call","indexOf","createDOMTemplate","domlib","escape","escapeHTML","html","strings","values","slice","arguments","result","string","i","type","domExists","appendTo","createID","push","m","match","replace","trim","domFrom"],"mappings":"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"}