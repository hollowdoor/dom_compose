{"version":3,"file":null,"sources":["../src/lib/set_events.js","../src/lib/set_elements.js","../src/lib/is_element.js","../src/lib/operations.js","../src/lib/global_dom_exists.js","../src/lib/move_style.js","../src/index.js"],"sourcesContent":["\nexport default function setEvents(root, events){\n\n    while(events.length){\n        let event = events.shift();\n        let element = root.querySelector(`[${event.attribute}=\"${event.id}\"]`);\n        if(element && event.event in element){\n            element.addEventListener(event.event, event.listener, false);\n            element.removeAttribute(event.attribute);\n        }\n\n    }\n};\n","import domSearchReplace from 'dom-search-replace';\n\nexport default function setElements(root, elements){\n    for(let element of elements){\n        domSearchReplace(root, element.id, element.element);\n    }\n    return root;\n};\n","export default function isElement(value) {\n    return (value && value.nodeType === 1) &&\n           (value && typeof value == 'object') &&\n           (Object.prototype.toString.call(value).indexOf('Element') > -1);\n}\n","import isElement from './is_element.js';\nimport nodeToString from 'dom-node-tostring';\nlet operations = [];\n\nObject.defineProperties(operations, {\n    appendTo: {\n        value: function(element){\n            if(typeof element === 'string'){\n                try{\n                    element = document.querySelector(element);\n                }catch(e){ throw new TypeError(element + ' is not a valid selector.') }\n            }\n\n            if(!isElement(element)){\n                throw new TypeError(element + ' is not a DOM element.')\n            }\n\n            element.appendChild(this[0]);\n        }\n    },\n    html: {\n        value: function(){\n            return nodeToString(this[0]);\n        }\n    }\n});\n\nexport default function createDOMOperations(dom){\n    let ops = Object.create(operations);\n\n    Object.defineProperties(ops, {\n        0: {\n            get: function(){\n                return dom;\n            }\n        }\n    });\n\n    return ops;\n};\n","export default\n    typeof document !== 'undefined' &&\n    typeof document.getElementById === 'function' &&\n    typeof document.createDocumentFragment === 'function';\n","import createID from 'really-unique-id';\n\nexport default function moveStyle(root){\n\n    let head = document.querySelector('head');\n    let styleIDs = [].slice.call(head.querySelectorAll('style'))\n    .map(style=>style.getAttribute('id'));\n\n    let styles = [].slice.call(root.querySelectorAll('style'))\n    .filter(style=>{\n        return styleIDs.indexOf(style.getAttribute('id')) === -1;\n    });\n\n    if(styles && styles.length){\n        styles.forEach(style=>head.appendChild(style));\n    }\n\n}\n","import setEvents from './lib/set_events';\nimport setElements from './lib/set_elements';\nimport createDOMOperations from './lib/operations';\nimport domExists from './lib/global_dom_exists';\nimport isElement from './lib/is_element.js';\nimport moveStyle from './lib/move_style.js';\nimport domFrom from 'dom-from';\nimport escapeHTML from 'escape-html';\nimport createID from 'really-unique-id';\n\nconst defaultOptions = {\n    domlib: createDOMOperations,\n    escape: escapeHTML\n};\n\nfunction createDOMTemplate({\n    domlib: domlib = createDOMOperations,\n    escape: escape = escapeHTML,\n    styleToHead: styleToHead = true\n} = {}){\n\n    return function html(strings){\n\n        const values = [].slice.call(arguments, 1);\n\n        let result = '',\n            string = strings[0],\n            elements = [],\n            events = [],\n            dom = null;\n\n        for(let i=0; i<values.length; i++){\n\n            let value = values[i];\n            let type = typeof value;\n\n            if(type === 'string'){\n                result += string + escape(value);\n            }else if(domExists){\n                if(type === 'object'){\n                    if(isElement(value) || typeof value.appendTo === 'function'){\n                        let id = createID();\n\n                        elements.push({\n                            id: id,\n                            element: value\n                        });\n\n                        result += string + id;\n                    }else{\n                        throw new TypeError(`${value} is not a valid element, or does not have\n                            an appendTo method.`);\n                    }\n                }else if(type === 'function'){\n                    let m;\n                    if(m = string.match(/[\\s](on[\\S]+)=$/)){\n\n                        let id = createID();\n                        events.push({\n                            id: id,\n                            attribute: m[1],\n                            event: m[1].replace('on', ''),\n                            listener: value\n                        });\n                        result += string + '\"' + id + '\"';\n                    }else{\n                        throw new TypeError(m[1]+' is not an event attribute.');\n                    }\n                }\n            }else{\n                result += string + escape(value);\n            }\n\n            string = strings[i + 1];\n        }\n\n        result = (result += string).trim();\n\n        if(domExists){\n            dom = domFrom(result);\n\n            dom = setElements(dom, elements);\n            setEvents(dom, events);\n\n            if(styleToHead){\n                moveStyle(dom);\n            }\n        }\n\n        return domlib(dom || result);\n    };\n}\n\n\nexport default createDOMTemplate;\n\n/*\ngit remote add origin https://github.com/hollowdoor/dom_compose.git\ngit push -u origin master\n*/\n"],"names":["setEvents","root","events","length","event","shift","element","querySelector","attribute","id","addEventListener","listener","removeAttribute","setElements","elements","isElement","value","nodeType","Object","prototype","toString","call","indexOf","operations","defineProperties","document","e","TypeError","appendChild","nodeToString","createDOMOperations","dom","ops","create","getElementById","createDocumentFragment","moveStyle","head","styleIDs","slice","querySelectorAll","map","style","getAttribute","styles","filter","forEach","createDOMTemplate","domlib","escape","escapeHTML","styleToHead","html","strings","values","arguments","result","string","i","type","domExists","appendTo","createID","push","m","match","replace","trim","domFrom"],"mappings":"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"}