{"version":3,"file":null,"sources":["../src/lib/set_events.js","../src/lib/set_elements.js","../src/lib/operations.js","../src/lib/global_dom_exists.js","../src/index.js"],"sourcesContent":["\nexport default function setEvents(root, events){\n\n    while(events.length){\n        let event = events.shift();\n        let element = root.querySelector(`[${event.attribute}=\"${event.id}\"]`);\n        if(element && event.event in element){\n            element.addEventListener(event.event, event.listener, false);\n            element.removeAttribute(event.attribute);\n        }\n\n    }\n};\n","import domSearchReplace from 'dom-search-replace';\n\nexport default function setElements(root, elements){\n    for(let element of elements){\n        domSearchReplace(root, element.id, element.element);\n    }\n    return root;\n};\n","import isElement from 'is-element';\nimport nodeToString from 'dom-node-tostring';\nlet operations = [];\n\nObject.defineProperties(operations, {\n    appendTo: {\n        value: function(element){\n            if(typeof element === 'string'){\n                try{\n                    element = document.querySelector(element);\n                }catch(e){ throw new TypeError(element + ' is not a valid selector.') }\n            }\n\n            if(!isElement(element)){\n                throw new TypeError(element + ' is not a DOM element.')\n            }\n\n            element.appendChild(this[0]);\n        }\n    },\n    html: {\n        value: function(){\n            return nodeToString(this[0]);\n        }\n    }\n});\n\nexport default function createDOMOperations(dom){\n    let ops = Object.create(operations);\n\n    Object.defineProperties(ops, {\n        0: {\n            get: function(){\n                return dom;\n            }\n        }\n    });\n\n    return ops;\n};\n","export default\n    typeof document !== 'undefined' &&\n    typeof document.getElementById === 'function' &&\n    typeof document.createDocumentFragment === 'function';\n","import setEvents from './lib/set_events';\nimport setElements from './lib/set_elements';\nimport createDOMOperations from './lib/operations';\nimport domExists from './lib/global_dom_exists';\nimport isElement from 'is-element';\nimport domFrom from 'dom-from';\nimport escapeHTML from 'escape-html';\nimport createID from 'really-unique-id';\n\nconst defaultOptions = {\n    domlib: createDOMOperations,\n    escape: escapeHTML\n};\n\nfunction createDOMTemplate({\n    domlib: domlib = createDOMOperations,\n    escape: escape = escapeHTML\n} = {}){\n\n    return function html(strings){\n\n        const values = [].slice.call(arguments, 1);\n\n        let result = '',\n            string = strings[0],\n            elements = [],\n            events = [],\n            dom = null;\n\n        for(let i=0; i<values.length; i++){\n\n            let value = values[i];\n            let type = typeof value;\n\n            if(type === 'string'){\n                result += string + escape(value);\n            }else if(domExists){\n                if(type === 'object'){\n                    if(isElement(value) || typeof value.appendTo === 'function'){\n                        let id = createID();\n\n                        elements.push({\n                            id: id,\n                            element: value\n                        });\n\n                        result += string + id;\n                    }else{\n                        throw new TypeError(`${value} is not a valid element, or does not have\n                            an appendTo method.`);\n                    }\n                }else if(type === 'function'){\n                    let m;\n                    if(m = string.match(/[\\s](on[\\S]+)=$/)){\n\n                        let id = createID();\n                        events.push({\n                            id: id,\n                            attribute: m[1],\n                            event: m[1].replace('on', ''),\n                            listener: value\n                        });\n                        result += string + '\"' + id + '\"';\n                    }else{\n                        throw new TypeError(m[1]+' is not an event attribute.');\n                    }\n                }\n            }else{\n                result += string + escape(value);\n            }\n\n            string = strings[i + 1];\n        }\n\n        result = (result += string).trim();\n\n        if(domExists){\n            dom = domFrom(result);\n\n            dom = setElements(dom, elements);\n            setEvents(dom, events);\n        }\n\n        return domlib(dom || result);\n    };\n}\n\n\nexport default createDOMTemplate;\n\n/*\ngit remote add origin https://github.com/hollowdoor/dom_compose.git\ngit push -u origin master\n*/\n"],"names":[],"mappings":"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"}