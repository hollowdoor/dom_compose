{"version":3,"file":null,"sources":["../src/lib/create_id.js","../src/lib/util/is_element.js","../src/lib/escape_html.js","../src/lib/set_events.js","../src/lib/set_elements.js","../src/lib/operations.js","../src/index.js"],"sourcesContent":["export default function createID(){\n    return Date.now()+randomNum();\n};\n\nfunction randomNum() {\n  // Math.random should be unique because of its seeding algorithm.\n  // Convert it to base 36 (numbers + letters), and grab the first 9 characters\n  // after the decimal.\n  return '_' + Math.random().toString(36).substr(2, 9);\n}\n","const isElement = (function () {\n    if(window === 'undefined') return function(){};\n    if (\"HTMLElement\" in window) {\n        return function (el) {return el instanceof HTMLElement;};\n    } else {\n        return function (el) {\n            return typeof el === \"object\" && el.nodeType === 1 && typeof el.nodeName === \"string\";\n        }\n    }\n})();\n\nexport default isElement;\n","const entities = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '/': '&#x2F;',\n    '`': '&#x60;',\n    '=': '&#x3D;'\n};\n\nconst replace = String.prototype.replace;\n\nexport default function escapeHtml(string) {\n    return replace.call(String(string), /[&<>\"'`=\\/]/g, (s)=>{\n      return entities[s];\n    });\n};\n\n//http://benv.ca/2012/10/02/you-are-probably-misusing-DOM-text-methods/\n","\nexport default function setEvents(root, events){\n\n    while(events.length){\n        let event = events.shift();\n        let element = root.querySelector(`[${event.attribute}=\"${event.id}\"]`);\n        if(element && event.event in element){\n            element.addEventListener(event.event, event.listener, false);\n            element.removeAttribute(event.attribute);\n        }\n\n    }\n};\n","const replaceWithNode = require('./replace_with_node');\nconst nodeToString = require('./node_tostring');\n\nexport default function setElements(root, elements){\n\n    const nodes = [].slice.call(root.childNodes);\n    const frag = document.createDocumentFragment();\n    const el = [].slice.call(elements);\n\n    if(!el.length){\n        return root;\n    }\n\n    for(let node of nodes){\n\n        for(let i=0; i<el.length; i++){\n            let element = el[i];\n            let text = nodeToString(node);\n\n            if(text.indexOf(element.id) !== -1){\n                let newNode = replaceWithNode(node, element.id, element.element);\n\n                if(newNode.childNodes.length){\n                    newNode = setElements(newNode, elements);\n                }\n\n                el.splice(i, 1);\n                root.replaceChild(newNode, node);\n                break;\n            }\n        }\n\n        if(!el.length) break;\n    }\n\n    return root;\n\n};\n","const isElement = require('./util/is_element');\nlet operations = [];\n\nObject.defineProperties(operations, {\n    appendTo: {\n        value: function(element){\n            if(typeof element === 'string'){\n                try{\n                    element = document.querySelector(element);\n                }catch(e){ throw new TypeError(element + ' is not a valid selector.') }\n            }\n\n            if(!isElement(element)){\n                throw new TypeError(element + ' is not a DOM element.')\n            }\n\n            element.appendChild(this[0]);\n        }\n    }\n});\n\nexport default function createDOMOperations(dom){\n    let ops = Object.create(operations);\n\n    Object.defineProperties(ops, {\n        0: {\n            get: function(){\n                return dom;\n            }\n        }\n    });\n\n    return ops;\n};\n","import createID from './lib/create_id';\nimport isElement from './lib/util/is_element';\nimport getParent from './lib/get_parent';\nimport escapeHtml from './lib/escape_html';\nimport setEvents from './lib/set_events';\nimport setElements from './lib/set_elements';\nimport createDOMOperations from './lib/operations';\nimport domFrom from 'dom-from';\n\n\nfunction html(strings){\n\n    const values = [].slice.call(arguments, 1);\n    let result = '',\n        string = strings[0],\n        elements = [],\n        events = [],\n        dom;\n\n    for(let i=0; i<values.length; i++){\n\n        let value = values[i];\n        let type = typeof value;\n\n        if(type === 'string'){\n            result += string + escapeHtml(value);\n        }else if(type === 'object'){\n            if(isElement(value) || typeof value.appendTo === 'function'){\n                let id = createID();\n\n                elements.push({\n                    id: id,\n                    element: value\n                });\n\n                result += string + id;\n            }else{\n                result += string + escapeHtml(value);\n            }\n        }else if(type === 'function'){\n            let m;\n            if(m = string.match(/[\\s](on[\\S]+)=$/)){\n\n                let id = createID();\n                events.push({\n                    id: id,\n                    attribute: m[1],\n                    event: m[1].replace('on', ''),\n                    listener: value\n                });\n                result += string + '\"' + id + '\"';\n            }else{\n                result += string + escapeHtml(value);\n            }\n        }else{\n            result += string + escapeHtml(value);\n        }\n\n        string = strings[i + 1];\n    }\n\n    result += string;\n\n    dom = domFrom(result);\n\n    dom = setElements(dom, elements);\n    setEvents(dom, events);\n\n    return createDOMOperations(dom);\n}\n\nexport default html;\n"],"names":["isElement"],"mappings":"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"}